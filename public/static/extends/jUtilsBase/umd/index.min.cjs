/**
 * 纯JS工具库 => jUtilsBase
 * @update 2025-10-09 09:36:51
 */
!function(t,n){"object"==typeof exports&&"undefined"!=typeof module?n(exports):"function"==typeof define&&define.amd?define(["exports"],n):n((t="undefined"!=typeof globalThis?globalThis:t||self).jUtilsBase={})}(this,(function(t){"use strict";var n=["A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z"],e="Array",r="Class",i="Function",a="Object",o="String",u="Number",c=void 0,l=Object.prototype.toString,f=encodeURI,s=decodeURIComponent;function d(t,n){return n=n||["-"],null===t||t===c||n.includes(t)}function h(t){return d(t)?"":String(t)}var v=i.toLowerCase();function m(t){return typeof t===v}function p(t){return m(n=t)&&/^class\s/.test(Function.prototype.toString.call(n))?r:l.call(t).slice(8,-1);var n}function g(t){return p(t)===e}function _(t){return p(t)===a}function y(t){return p(t)===o}function b(t,n){var e;try{e=JSON.parse(t)}catch(r){e=n}return e}function x(t){return _(t)||_(t=b(t))||(t={}),t}function T(t){return d(t)||""===t}function w(t){var n=[];function r(t,e){null!=t&&""!==t&&(e=null==(e=m(e)?e():e)?"":e,n[n.length]=f(t)+"="+f(e))}return function i(t,n){var u,c;if(t)switch(p(n)){case e:for(u=0;u<n.length;u++)i(t+"["+("object"==typeof n[u]&&n[u]?u:"")+"]",n[u]);break;case a:for(c in n)i(t+"["+c+"]",n[c]);break;default:r(t,n)}else switch(p(n)){case o:case a:for(c in n)i(c,n[c]);break;case e:for(u=0;u<n.length;u++)r(n[u].name,n[u].value)}}("",t),n.join("&")}function k(t){return g(t)||g(t=b(t))||(t=[]),t}function E(t){return p(t)===u}var I="[\\s\\uFEFF\\xA0]+";function C(t,n){var e=p(t);e===u&&(t=String(t),e=o);var r="";if(e===o){switch(n){case 1:r="^"+I;break;case-1:r=I+"$";break;case"*":r=I;break;default:r="^"+I+"|"+I+"$"}return t.replace(new RegExp(r,"g"),"")}return""}function R(t){var n=!1,e=0;return E(t)?e=t:y(t)?(t=C(t,"*").replace(/,/g,"").replace(/%$/,(function(t){return n=!0,""})),e=Number(t)):e=Number(t),e=Math.abs(e)===Math.abs(Infinity)||isNaN(e)?0:e,n&&(e/=100),e}var S=/(-|\+)?((\d+)|((\d,?)+\d+))(\.?\d+)?%?/.toString().replace(/(^\/)|(\/$)/g,"");function A(t){var n=C(t);return new RegExp("^"+S+"$").test(n)}var M=[c,c];function D(t,n,e){var r=F(n),i=r[0];O(i)?(i=R(i),r[1]==c?t.push(e):(/^\[[\D]+\]/.test(r[1])?t[i]=x(t[i]):t[i]=k(t[i]),D(t[i],r[1],e))):r[1]==c?t[i]=e:(/^\[[\D]+\]/.test(r[1])?t[i]=x(t[i]):t[i]=k(t[i]),D(t[i],r[1],e))}function F(t){if(t==c)return M;var n,e=t;return t.replace(/^\[(.*?)\](.*)?/,(function(t,r,i){return e=r,n=i,""})),[e,n]}function O(t){return""===t||/^\d+$/.test(t)}function N(t){var n={},e=!1,r="";return d(t)&&(t=""),t.replace(/([^=&?/#]*?)=([^=&?/#]*)/g,(function(t,i,a){var o;o=s(a),a=null==o?c:"false"!==o&&("true"===o||(A(o)?o:b(o,o))),r=s(i),e=!1,""!==r&&(r.replace(/(.*?)(\[.*)/,(function(t,r,i){var o=F(i);e=!0,O(o[0])?n[r]=k(n[r]):n[r]=x(n[r]),D(n[r],i,a)})),e||(n[r]=a))})),n}function L(t,n){for(var e=0;e<t.length;e++)n(t[e],e,t)}function P(t){var n;switch(p(t)){case r:n=Object.assign(Object.create(Object.getPrototypeOf(t)),t);break;case e:n=[];for(var o=0;o<t.length;o++)n.push(P(t[o]));break;case a:n={},L(Object.keys(t),(function(e){n[e]=P(t[e])}));break;case i:function c(){t.apply(this,arguments)}for(var u in t.prototype)c.prototype[u]=t.prototype[u];n=c;break;default:n=t}return n}function j(t,n){var e=!1;return(g(t)&&n.array&&0===t.length||_(t)&&n.kvPair&&function(t){var n=!0;for(var e in t)if(e!==c){n=!1;break}return n}(t)||y(t)&&n.string&&""===t||d(t))&&(e=!0),e}function $(t,n){if(_(t))for(var e in t){var r=t[e];(g(r)||_(r))&&$(r,n),j(r,n)&&delete t[e]}}function V(t,n,e){var r;e=null==e?60:e,t()?n():(clearTimeout(r),r=setTimeout((function(){V(t,n,e)}),e))}V.async=function(t,n){return new Promise((function(e){V(t,e,n)}))};var q={};var B={id:"id",children:"children"};function U(t,n){var e="";if((t=h(t)).length*n<1<<28)for(;1&~n||(e+=t),0!=(n>>>=1);)t+=t;return e}function z(t,n,e,r){return n|=0,(t=h(t)).length>n?t:(n-=t.length,e.length<n&&(e+=U(e,n/e.length)),-1===r?e.slice(0,n)+t:t+e.slice(0,n))}function K(t,n,e){return z(t,n,e,-1)}function G(t,n,e){return z(t,n,e,1)}function W(t,n){return""!==t?t.split(n):[]}function Y(t,n,e){t=R(t);var r=Math.pow(10,n),i=(t<0?"-":"")+h(Math.round(Math.abs(t*r))/r);if(n>0){var a=W(i,"."),o=a[0],u=a[1]||"";u.length<n&&(u=G(u,n,"0"),e&&(u=u.replace(/0+$/,"")),i=u?o+"."+u:o)}return i}function H(t,n,e){var r,i,a=d(e)?"children":e;return function o(t){if(t)for(var e=0;e<t.length;e++){if(i=n(t[e])){r=t[e];break}if(o(t[e][a]),i)break}}(t),r}function X(t,n){for(var e,r=(n=x(n)).id||"id",i=n.pid||"pid",a=n.children||"children",o=0;o<t.length;o++){var u=t[o];(e=H(t,(function(t){return null!=t[r]&&t[r]!=u[r]&&t[r]===u[i]}),a))&&(e[a]=k(e[a]),e[a].push(u),t.splice(o--,1))}return t}function Z(t,n,e){var r=!1===e?0:1;return t=Math.random()*(n-t+r)+t,r?Math.floor(t):t}function J(){return n[Z(0,n.length-1)][0]}function Q(t,n){for(var e="",r=0;r<20;r++)e=J()+e+Z(1,9);var i=(new Date).getTime()*Z(1,100),a=t+J()+Number(e).toString(32).substring(0,12)+i.toString(32).substring(0,12);return a.length<n?Q(a,n):a.substring(0,n)}function tt(t){return Q("",t=R(t)||20)}function nt(t,n,e,r){r=r||"children";var i=[];return function a(t,i){for(var o=0;o<t.length;o++){var u=e(t[o]);d(u)||(i[o]=P(u),t[o][r]&&(i[o][n]=[],a(t[o][r],i[o][n])))}}(t,i),i}var et={};function rt(t,n,e){e=e||"children",function r(t,i){for(var a=0;a<t.length;a++){var o=P(i);n(t[a],o),g(t[a][e])&&(o.push(t[a]),r(t[a][e],o))}}(t,[])}function it(t,n){}var at=function(){function t(t){this._timer=void 0,this._timer_info=void 0,this._stamp=0,this._passStamp=0,this._option=void 0,this._option=Object.assign({timeout:6e3,interval:1e3,handler:it},t),this._next=this._next.bind(this),this._doOnce=this._doOnce.bind(this),this.done=this.done.bind(this)}var n=t.prototype;return n._next=function(){return clearInterval(this._timer),this._passStamp=+new Date-this._stamp,this._timer=setTimeout(this._doOnce,this._option.interval),this},n._doOnce=function(){if(this._passStamp>=this._option.timeout)return this._option.onMessage&&this._option.onMessage(0),this.done(),this;this._option.handler(this._next,this.done)},n.start=function(){var t=this;this._stamp=+new Date,this.done(),this._doOnce();var n=0,e=0;return this._option.onMessage&&(clearInterval(this._timer_info),this._timer_info=setInterval((function(){n=+new Date-t._stamp,0===(e=Math.max(t._option.timeout-n,0))&&t.done(),t._option.onMessage(e)}),100)),this},n.done=function(){return clearTimeout(this._timer),clearTimeout(this._timer_info),this},n.dispose=function(){return this.done(),this},t}();function ot(t,n,e,r,i){var a;if(e&&T(n)&&(a="不能为空"),p(n)!==r)switch(r){case"String":n=String(n);break;case"Number":A(n)?n=Number(n):a="必须为数字"}return!a&&i&&(a=i(n)),a&&(a="["+t+"]："+a),{value:n,error:a}}var ut={number:function(t,n,e,r){return ot(t,n,!!e,"Number",r)},string:function(t,n,e,r){return ot(t,n,!!e,"String",r)}};function ct(t){return Array.from(new Set(t))}var lt=function(t,n){return Number(t)-Number(n)},ft=0,st={};function dt(t,n){var e=[],r=[];return t.forEach((function(t){var i=function(t){return st[t]||(st[t]={id:++ft,label:t}),st[t]}(n[t]);e.push(i.id),r.push(i.label)})),{id:e.join("_"),label:r.join("→")}}function ht(t,n){return t===c||n===c?c:(n-t)/Math.abs(t)}function vt(t){return W(t,"").map((function(t){return t.replace(/\(/g,"\\(").replace(/\)/,"\\)").replace(/\+/,"\\+").replace(/\[/,"\\[").replace(/\]/,"\\]")})).join(".*?")}function mt(t,n){var e={},r=-1;for(var i in t)r++,e[i]=n(t[i],i,r);return e}function pt(t){return t.map((function(t,n){return{value:t,index:n}}))}function gt(t,n){return 0===t||d(t)?0:0===n||d(n)?1:t/n}function _t(t,n,e){var r=[];return t.forEach((function(t){!n.some((function(n){return e(n,t)}))&&r.push(t)})),n.forEach((function(n){!t.some((function(t){return e(t,n)}))&&!r.some((function(t){return e(t,n)}))&&r.push(n)})),r}function yt(t,n,e,r){if(t===n)return t;if(d(n,r)||T(n))return t;var i=n;return e?e(i):i}var bt="sys-row-avg";function xt(t,n){var e=[];return g(t)?t.forEach((function(t){e.push(n[t])})):e.push(n[t]),e.join("→")}function Tt(t,n){var e={},r=n.colField;if(d(r)||!t.length)return e;var i=n.cellSummary;if(t.forEach((function(t){var n=t[r];if(e[n]=e[n]||{data:[],summary:0,_collect:[]},e[n].data.push(t),i){var a=t[i.numerator[0]];e[n].summary+=a,e[n]._collect.push(a)}})),d(i))return e;var a,o,u=function(t){var n=e[t],r=1,a=i.denominator;if(a)if(E(a))r=a;else switch(a[1]){case"length":r=n.data.map((function(t){return t[a[0]]})).length;break;case"uniqLength":r=ct(n.data.map((function(t){return t[a[0]]}))).length}switch(i.numerator[1]){case"sum":d(n.summary)||(n.summary=n.summary/r);break;case"length":n.summary=n._collect.length/r;break;case"uniqLength":n.summary=ct(n._collect).length/r}};for(var c in e)u(c);function l(t){var n=0,r=function(t){return Object.keys(t)}(e).filter((function(n){var e=[bt].includes(n),r="*"===t[1]||t[1].includes(n);return!e&&r}));return g(t[1])&&r.sort((function(n,e){return t[1].indexOf(n)-t[1].indexOf(e)})),r.forEach((function(r,i){var a=e[r],o=0;if(d(t[2])||"value"===t[2])o=d(a.summary)?0:a.summary;else if("length"===t[2]){var u=t[3];u&&(o=a.data.map((function(t){return t[u]})).length)}else if("uniqLength"===t[2]){var c=t[3];if(c)o=ct(a.data.map((function(t){return t[c]}))).length}"sum"===t[0]?n+=o:"max"===t[0]?n=Math.max(n,o):"diff"===t[0]&&(0===i?n=o:n-=o)})),n}return a=0,o=0,mt(e,(function(t){a++;var n=d(t.summary)?0:t.summary;o+=n})),e[bt]={data:[],summary:o/a,_collect:[]},n.colCustom&&mt(n.colCustom,(function(t,n){var r=l(t.numerator),i=t.denominator?l(t.denominator):1;e[n]={data:[],summary:gt(r,i),_collect:[]}})),e}function wt(t,n,e,r){var i=[];for(var a in t){var o=n===e,u=wt(t[a].child,n,e+1,r);i.push({uidPath:t[a].uidPath,uid:t[a].uid,data:t[a].data,_columnRiseRatio:{},_columnTotal:{},_columnProportion:{},_columns:Tt(t[a].data,r),isLeaf:o,children:u})}return i}function kt(t,n){var e={};!function o(t,e,r){for(var i=r.length,a=0;a<e.length;a++){var u=e[a],c=xt(n.path[i].field,u);t[c]=t[c]||{uidPath:r.concat(c),uid:c,data:[],child:{}},t[c].data.push(u)}if(i<n.path.length-1)for(var l in t)o(t[l].child,t[l].data,t[l].uidPath)}(e,t,[]);var r=wt(e,n.path.length-1,0,n);!function u(t,e){var r;t.sort(null===(r=n.path[e])||void 0===r?void 0:r.sort),t.forEach((function(t){u(t.children,e+1)}))}(r,0),function l(t){t.forEach((function(t){var n={};mt(t._columns,(function(t,e){var r=d(t.summary)?0:t.summary;n[e]=n[e]||0,n[e]+=r})),t._columnTotal=n,l(t.children)}))}(r);var i={};r.forEach((function(t){mt(t._columns,(function(n,e){i[e]=i[e]||0,i[e]+=t._columnTotal[e]}))}));var a=[];return n.colCustom&&mt(n.colCustom,(function(t,n){t.riseRatio||a.push(n)})),function f(t){var n={},e={};t.forEach((function(t,r){mt(t._columns,(function(t,i){if(!a.includes(i)){if(r>0){var o=t.summary;if(d(o))e[i]=c;else{var u,l=null!==(u=n[i])&&void 0!==u?u:0;e[i]=gt(o-l,l)}}else e[i]=void 0;n[i]=t.summary}})),t._columnRiseRatio=e,f(t.children)}))}(r),function s(t,n){t.forEach((function(t,e){var r={};mt(t._columns,(function(t,e){r[e]=gt(t.summary,n[e])})),t._columnProportion=r,s(t.children,t._columnTotal)}))}(r,i),{data:r,total:i}}function Et(t){return d(t)||0===t}var It=[[1e4,"万"],[1e8,"亿"]];function Ct(t,n,e){var r=d(e)?It:e;r.sort((function(t,n){return n[0]-t[0]}));for(var i=t,a="",o=0;o<r.length;o++){var u=r[o],c=t/u[0];if(Math.abs(c)>=1){i=c,a=u[1];break}}return{value:i,fmtValue:n(i),data:t,unit:a}}function Rt(t,n){return K(t,n,"0")}function St(t){var n=new Date(t),e=n.getFullYear(),r=n.getMonth()+1,i=n.getDate(),a=n.getHours(),o=n.getMinutes(),u=n.getSeconds(),c=n.getMilliseconds();return Rt(e,4)+"/"+Rt(r,2)+"/"+Rt(i,2)+" "+Rt(a,2)+":"+Rt(o,2)+":"+Rt(u,2)+":"+Rt(c,3)}function At(t){var n=0;return g(t.children)?t.children.forEach((function(t){n+=At(t)})):n=1,n}function Mt(t,n,e,r){return n[e]||(n[e]=[]),r-=1,t.forEach((function(t){var i=r+1,a={colStart:i,colEnd:r=i+t.count-1,colSpan:r-i+1,count:t.count,field:t.field,title:t.title,rowSpan:1};n[e][i]=a;for(var o=1;o<t.count;o++)n[e][i+o]=void 0;g(t.children)&&t.children.length>0&&Mt(t.children,n,e+1,i)})),n.forEach((function(t){for(var e=0;e<n[0].length;e++)t[e]||(t[e]=void 0)})),n}function Dt(t){for(var n=[],e=t.length-1;e>=0;e--)t[e].forEach((function(t,e){t&&t.field&&d(n[e])&&(n[e]=t.field)}));return n}function Ft(t){t.forEach((function(n,e){n.forEach((function(n,r){n&&(n.rowSpan=function(n,e){for(var r=0;n<t.length;n++){var i;if(null!=t&&null!==(i=t[n])&&void 0!==i&&i[e])break;r++}return r}(e+1,r)+1)}))}))}var Ot=new(function(){function t(){this._list={}}var n=t.prototype;return n._resetGroupClickXAxisCategory=function(t){t.forEach((function(n){clearTimeout(n.timer_01),n.instence.off("click",n.onAxxisSeriesClick),n.instence.off("click",n.onAxxisCategoryClick),n.onAxxisCategoryClick=function(e){var r=e.tickIndex,i=!1!==e.needEmit;clearTimeout(n.timer_01),n.timer_01=setTimeout((function(){t.forEach((function(t){var n=P(t.instence.getOption());if(n&&g(n.xAxis)&&n.xAxis.length&&i&&t.config&&t.config.onXAxisCtegoryClick){var e=n.xAxis;t.config.onXAxisCtegoryClick(e.map((function(t){return t.data})),r,t.instence)}}))}),30)},n.onAxxisSeriesClick=function(t){"markLine"!==t.componentType&&null!=n&&n.onAxxisCategoryClick&&n.onAxxisCategoryClick({tickIndex:t.dataIndex})},n.instence.on("click","series",n.onAxxisSeriesClick),n.instence.on("click","xAxis.category",n.onAxxisCategoryClick)}))},n.clickXAsisCategory=function(t,n,e){var r=!0!==e;for(var i in this._list)for(var a=0;a<this._list[i].length;a++){var o=this._list[i][a];o.instence===t&&o.onAxxisCategoryClick&&o.onAxxisCategoryClick({tickIndex:n,needEmit:r})}},n.add=function(t,n){var e=t.group;return e?(this._list[e]=this._list[e]||[],this._list[e].push({config:n,instence:t,timer_01:-1}),this._resetGroupClickXAxisCategory(this._list[e]),this):this},n.remove=function(t){if(t)for(var n in this._list)for(var e=0;e<this._list[n].length;e++){var r=this._list[n][e];clearTimeout(r.timer_01),r.instence===t&&(r.instence.off("click",r.onAxxisCategoryClick),this._list[n].splice(e--,1))}},t}());function Nt(t,n){L(t,(function(t){g(t.children)?Nt(t.children,n):n.push(t)}))}function Lt(t){var n=[];return Nt(t,n),n}var Pt=function(){function t(t){this._timer=void 0,this._passTime=0,this._options=void 0,this._middleData=void 0,this._options=t,this._middleData=P(t.to)}var n=t.prototype;return n.start=function(){var t=this,{from:n,to:e,easing:r,duration:i,onChange:a}=this._options,o=(new Date).getTime()-this._passTime;return clearInterval(this._timer),this._timer=setInterval((function(){var u=Math.min((new Date).getTime()-o,i);!function l(t,n,e){function a(a){if(E(n[a])||E(e[a])){var o=R(n[a]),c=R(e[a])-o;t[a]=r(u,o,c,i)}else(g(n[a])||_(n[a]))&&l(t[a],n[a],e[a])}if(g(n))for(var o=0;o<n.length;o++)a(o);else if(_(n))for(var c in t)a(c)}(t._middleData,n,e);var c=u/i;1===c&&(clearInterval(t._timer),u=0),t._passTime=u,a(t._middleData,c)}),17),this},n.stop=function(){return clearInterval(this._timer),this},n.dispose=function(){this.stop()},t}();function jt(t,n){return Object.assign(t,n)}var $t=[[1,"Byte"],[1024,"KB"],[1048576,"MB"],[1073741824,"GB"],[1099511627776,"TB"]];function Vt(t,n){var e,r,i,a,o=n&&n.spaceRatio?n.spaceRatio:0,u=n&&n.getter,c=n&&n.formatter,l=0;(L(t,(function(t){var n=u?u(t):function(t){return A(t)?R(t):undefined}(t),i=A(n)?R(n):undefined;d(i)||(e=d(e)?i:Math.min(e,i),r=d(r)?i:Math.max(r,i))})),d(e)||d(r))||((l=(r-e)*o)<1?(i=e-l,a=r+l):(i=+Y(e-l,0),a=+Y(r+l,0)),c&&(i=c(i),a=c(a)));return{min:i,max:a}}var qt=["","十","百","千"],Bt=["","万","亿","兆","京"],Ut=["零","一","二","三","四","五","六","七","八","九"],zt=qt.length;function Kt(t){return Ut[R(t)]}var Gt=0,Wt=[];function Yt(t,n,e,r){var i="L"+ ++Gt,a=St((new Date).getTime());return Wt.push({time:a,id:i,pid:e,title:t,data:n}),r&&console.log("%c 写入日志","background:#dd4215;color:white;font-size:12px;border-radius:4px;padding: 2px 4px 2px 0",a+" →",t),i}var Ht=function(){function t(t,n){this._diff=0,this._interval=void 0,this._handler=void 0,this._timer=void 0,this._actionId=Number.MIN_SAFE_INTEGER,this._isRuning=!1,this._interval=t,this._handler=n}var n=t.prototype;return n._refresh=function(){var t=this;if(this._isRuning){var n=+this._actionId;this._isRuning=!0,clearTimeout(this._timer),this._handler((function(e){n===t._actionId&&(t._diff=e-(new Date).getTime(),clearTimeout(t._timer),t._timer=setTimeout((function(){t._refresh()}),t._interval))}))}},n.updateOnce=function(t){var n=this,e=this._isRuning;this._handler((function(r){n._diff=r-(new Date).getTime(),t(),e&&n.play()}))},n.play=function(){return this._isRuning=!0,this._refresh(),this},n.pause=function(){return this._isRuning=!1,clearTimeout(this._timer),this},n.getDiff=function(){return this._diff},n.getTime=function(){return(new Date).getTime()+this._diff},t}();var Xt=864e5,Zt=7*Xt;function Jt(t){var n=new Date(t),e=n.getFullYear(),r=n.getMonth()+1,i=n.getDate();return K(e,4,"0")+"-"+K(r,2,"0")+"-"+K(i,2,"0")}function Qt(t){for(var n=[],e=function(t,n,e){var r=new Date(t,n,e),i=r.getDay();0===i&&(i=7);var a=new Date(r.getFullYear()).getTime(),o=Math.max(r.getTime()-Xt*(i-1),a),u=r.getTime()+Xt*(7-i);return{start:St(o),now:St(r.getTime()),end:St(u),startStamp:o,endStamp:u,year:r.getFullYear(),month:r.getMonth()+1,day:r.getDate(),week:i}}(t.getFullYear(),t.getMonth(),t.getDate()),r=new Date(e.year+"/12/31 00:00:00").getTime(),i=new Date(t.getFullYear(),0,1).getTime(),a=e.endStamp;a>=i;)n.push({start:Jt(Math.max(a-Zt+Xt,i)),end:Jt(Math.min(a,r))}),a-=Zt;var o=n.length;return n.map((function(t,n){return{week:o-n,label:"第"+(o-n)+"周",from:t.start,to:t.end}})).reverse()}function tn(t,n){for(var e=Qt(new Date(t)),r=!d(n);r&&e.length<n;){var i=new Date(e[0].from).getTime()-Xt;e=Qt(new Date(i)).concat(e)}return r?e.slice(e.length-n):e}var nn=["COMPLETE_VALUE_RATE","COMMENT","SCORE_ACTUAL"];function en(t){switch(t){case 1:return"原始文本";case 2:return"富文本";case 3:return"定制业务";case 4:return"跳转链接"}}function rn(t){return"col_"+t}function an(t,n){n.ext.attrs.forEach((function(e){t.push({dataId:n.id,content:e.value,rowspan:1,colspan:1,meta:{attrId:e.attrId,cellId:e.taskId,comment:n.ext.comment,scoreActual:n.ext.scoreActual,completeRate:n.ext.completeRate,completeValue:n.ext.completeValue}})}))}function on(t,n,e,r){var i=e-1;return t.forEach((function(t,e){for(var a,o=Lt(null!==(a=t.children)&&void 0!==a?a:[]).length||1,u=0;u<o;u++){i++,n[i]=n[i]||[];var c={dataId:t.id,content:t.label,rowspan:u>0?0:o,colspan:1,meta:t.meta,test:"===="};n[i][r]=c,t.children?c.rowspan&&on(t.children,n,i,r+1):(t.ext.attrs.push({attrId:"SCORE_ACTUAL",value:t.ext.scoreActual}),t.ext.attrs.push({attrId:"COMMENT",value:t.ext.comment}),t.ext.attrs.push({attrId:"COMPLETE_VALUE_RATE",value:t.ext.completeValue}),an(n[i],t))}})),n}function un(t,n){var e={},r=[];return n.forEach((function(n){nn.includes(n.attrKey)&&(n.attrId=n.attrKey);var i=function(t,n){var e=1;return n.forEach((function(n){var r=n.filter((function(n){return n.meta.attrId===t})).length;e=Math.max(r,e)})),e}(n.attrId,t);e[n.attrId]=i;for(var a=0;a<i;a++)r.push({attrId:n.attrId,attrIndex:a,colspan:0===a?i:0,label:n.attrName})})),{list:r,count:e}}t.Animate=Pt,t.Polling=at,t.ServerDate=Ht,t._Array=k,t._Boolean=function(t){return!0===t||"true"===t||"1"===t||1===t},t._KvPair=x,t._Number=R,t._String=h,t.arrayRemove=function(t,n){for(var e=0;e<t.length;e++)n(t[e])&&t.splice(e--,1)},t.arrayRowToColumn=function(t,n){var e,r=[];t.forEach((function(t){var e=String(t[n.colField]);r.includes(e)||r.push(e)})),r.sort(null!==(e=n.colSort)&&void 0!==e?e:lt);var i={};t.forEach((function(t){var e=dt(n.uniqueRowId,t),r={};n.uniqueRowId.forEach((function(n){r[n]=t[n]})),i[e.id]=i[e.id]||{value:r,name:e.label,data:{}};var a=n.colCreate(t[n.colField]).field;i[e.id].data[a]=i[e.id].data[a]||[],i[e.id].data[a].push(t)}));var a=[];for(var o in i)a.push({name:i[o].name,value:i[o].value,data:i[o].data,summary:{}});var u,l,f,s=r.map((function(t){var e=n.colCreate(t);return{value:t,label:e.label,field:e.field}})),d={};return n.summaryConfig&&(n.summaryConfig.row&&(u=a,l=n.summaryConfig.row,f=n.summaryConfig.averageField,u.forEach((function(t){var n=l[t.name];if(n){var e,r=0,i=0,a=function(a){var o;i++;var u=[],c=0,l=[],f=[];t.data[a].forEach((function(t){E(n.count)||u.push(t[n.count.field]);var e=R(t[n.value.field]);switch(n.value.mode){case"uniqLength":l.push(t[n.value.field]),l=ct(l),c=l.length;break;case"sum":case"avg":c+=e}0!==e&&f.push(e)}));var s=0;if(E(n.count))s=n.count;else switch(n.count.mode){case"length":s=u.length;break;case"uniqLength":s=ct(u).length;break;case"notZeroValue":s=f.length}var d=c;"avg"===n.value.mode&&(d=c/s),r+=d,t.summary[a]={value:d,proportion:0,riseRatio:e?ht(null===(o=t.summary[e])||void 0===o?void 0:o.value,d):void 0},e=a};for(var o in t.data)a(o);t.summary[f]={value:r/i,riseRatio:c,proportion:0}}})),u.forEach((function(t){var n=l[t.name];if(n){var e=u.find((function(t){return t.name===n.proportionBaseField}));if(n.proportionBaseField&&e)for(var r in t.summary)t.summary[r].proportion=t.summary[r].value/e.summary[r].value}})),a=u),n.summaryConfig.column&&(d=function(t,n,e){var r={},i={},a=function(a){i[a]={},r[a]={};var o=n[a];t.forEach((function(t){var n=function(n){r[a][n]=r[a][n]||{data:[],sum:0};var e=[],i=0;switch(t.data[n].forEach((function(t){switch(e.push(t[o.field]),o.mode){case"uniqLength":e=ct(e);break;case"avg":case"sum":i+=t[o.field];break;case"notZeroLength":0!==R(t[o.field])&&i++}})),o.mode){case"uniqLength":e=ct(e);break;case"avg":i/=t.data[n].length}r[a][n].data=r[a][n].data.concat(e),r[a][n].sum+=i};for(var e in t.data)n(e)}));var u=void 0;for(var l in r[a]){var f,s=0;switch(o.mode){case"avg":s=r[a][l].sum/t.length;break;case"uniqLength":s=ct(r[a][l].data).length;break;case"notZeroLength":case"sum":s=r[a][l].sum}i[a][l]={value:s,proportion:0,riseRatio:u?ht(null===(f=i[a][u])||void 0===f?void 0:f.value,s):void 0},u=l}var d=0,h=0;for(var v in i[a]){d+=i[a][v].value,h++}i[a][e]={value:d/h,riseRatio:c,proportion:0}};for(var o in n)a(o);return i}(a,n.summaryConfig.column,n.summaryConfig.averageField))),{columns:s,data:a,colSummary:d,getExtRow:function(t,n,e){var r=a.find((function(n){return n.name===t})),i={};if(!r)return function(t,n,e){var r=d[t],i={};if(!r)return i;for(var a in r)i[a]=e(r[a][n]);return i}(t,n,e);for(var o in r.summary)i[o]=e(r.summary[o][n]);return i}}},t.breakString=function(t,n){for(var e=C(n),r=[],i=0;i<e.length;i+=t)r.push(e.substring(i,i+t));return r},t.changeIndex=function(t,n,e){if(t<0)return n;var r=t+1;return(n=(n+e)%r)<0&&(n+=r),0===n?0:n},t.checkPhone=function(t){var n=C(t);return/^(\+86)?\s?1\d{10}$/.test(n)||/^0\d{2,3}-\d{7,8}$/.test(n)},t.cloneEasy=P,t.connectEcharts=Ot,t.createIdFactory=function(t){var n=-1,e={};return function(r){return d(e[r])&&(++n>=9999999999999&&(t=""+t+n+"_",n=0),e[r]=""+t+n),e[r]}},t.dataCache=function(t,n){var e=n||q;e[t]=e[t]||{count:0,complete:!1,data:null};var r=e[t];return r.count++,{isExist:function(){return r.count>1},set:function(t){r.complete=!0,r.data=JSON.stringify(t)},get:function(t){V((function(){return r.complete}),(function(){t(b(r.data))}),100)},logs:e}},t.dataPage=function(t,n,e){if(e<1)throw"页码必须大于0";var r=(e-1)*n,i=r+n;return{current:e,total:t.length,size:n,pages:Math.ceil(t.length/n),data:P(t.slice(r,i))}},t.debounce=function(t,n,e){var r,i,a,o,u=yt(500,n),{leading:c,trailing:l}=jt({leading:!1,trailing:!0},e),f=!1,s=!1;function d(){clearTimeout(r),r=setTimeout(h,u)}function h(){f=!1}function v(){f=!0,d(),t.apply(self,o)}function m(){if(!s){a=this;for(var n=arguments.length,e=new Array(n),r=0;r<n;r++)e[r]=arguments[r];o=e,c&&(f||(f=!0,t.apply(a,o)),d()),l&&(clearTimeout(i),i=setTimeout(v,u))}}return m.cancel=function(){clearTimeout(r),clearTimeout(i)},m.dispose=function(){clearTimeout(r),clearTimeout(i),s=!0},m},t.deepFindItem=H,t.deepFindTreePath=function(t,n,e){e=Object.assign(B,e);for(var r=[],i=P(t),a=new Set,{children:o}=e;i.length;){var u=i[0];if(a.has(u))r.pop(),i.shift();else if(a.add(u),u[o]&&i.unshift.apply(i,u[o]),r.push(u),n(u))return r}return[]},t.defineEventBus=function(t){if(et[t])throw'"'+t+'" Has already been registered!';return et[t]=et[t]||[],{on:function(n){et[t].push(n)},emit:function(){for(var n=arguments.length,e=new Array(n),r=0;r<n;r++)e[r]=arguments[r];for(var i=0;i<et[t].length;i++)et[t][i].apply(c,e)},off:function(n){if(!n)throw"the hander of off is required!";for(var e=0;e<et[t].length;e++)et[t][e]===n&&et[t].splice(e--,1)},dispose:function(){for(var n=0;n<et[t].length;n++)et[t].splice(n--,1);delete et[t]},eventList:function(){return et[t]}}},t.defualtFormatter=yt,t.difference=_t,t.fieldCheck=ut,t.fileSizeFormatter=function(t,n){var e=Ct(t,n,$t);return{value:e.value,unit:e.unit,text:e.fmtValue}},t.fileSizeToNumber=function(t,n){return t*$t.find((function(t){return t[1]===n}))[0]},t.filterWithMove=function(t,n){for(var e=[],r=0;r<t.length;r++){var i=t[r];n(i,r,t)&&(e.push(i),t.splice(r--,1))}return e},t.findKvPair=function(t,n){for(var e in t)if(n(t[e],e))return t[e]},t.findLast=function(t,n){for(var e=t.length-1;e>=0;e--)if(n(t[e],e,t))return t[e]},t.floorFixed=function(t,n,e){var r=W(t=C(R(t)),"."),i=r[1]||"";return i.length<n&&(i=G(i,n,"0"),e&&(i=i.replace(/0+$/,""))),n<1||!i?r[0]:r[0]+"."+i.substring(0,n)},t.forEach=L,t.forEachKvPair=mt,t.forEachTree=rt,t.formatRange=function(t,n,e){var r=T(e)?"-":e,i=!d(t),a=!d(n);return i&&a?t===n?C(t):""+C(t)+r+C(n):C(i?t:n)},t.formatTime=St,t.fuzzyReplace=function(t,n,e){if(d(t)||d(n))return n;if(t=C(t,"*")){var r=vt(t),i=new RegExp(r,h(e));n=n.replace(i,(function(t){return'<em class="g_search_highlight">'+t+"</em>"}))}return n},t.getArray=function(t,n,e){for(var r=Math.min(t.length,n+e),i=[];n<r;n++)i.push(t[n]);return i},t.getFileName=function(t){var n=C(t).replace(/\\+/g,"/");return n=n.replace(/^.*\/(.*?\.*)$/,"$1")},t.getLikeNumberRegExp=function(){return S},t.getMinAndMax=Vt,t.getPiecesWithIndex=function(t,n){var e=[];return L(t,(function(t,r){var i=n.find((function(n){return t>=n.min&&t<n.max}));i&&e.push({gte:r,lt:r+1,color:i.color})})),e},t.getRandom=Z,t.getRatio=gt,t.getRiseRatio=function(t,n){return Et(t)&&Et(n)?0:Et(t)?1:Et(n)?-1:(n-t)/t},t.getSortIndex=function(t,n){var e=pt(t),r=pt(t);return r.sort((function(t,e){return n(t.value,e.value)})),e.map((function(t){return r.findIndex((function(n){return t.index===n.index}))}))},t.getType=p,t.getWeekSort=function(t){return tn(t).length},t.getWeeks=tn,t.hexToRgba=function(t,n){if(t.length<7)throw"颜色格式不正确，必须6位的十六进制颜色";for(var e=yt(1,n),r=[],i=1;i<7;i+=2)r.push(parseInt("0x"+t.slice(i,i+2)));return"rgba("+r.join(",")+","+e+")"},t.isArray=g,t.isEmpty=T,t.isFunction=m,t.isFuzzyMatch=function(t,n,e){if(d(t)||""===t)return!1;var r=!0;if(t=C(t,"*")){var i=vt(t);r=new RegExp(i,h(e)).test(n)}return r},t.isKvPair=_,t.isLikeNumber=A,t.isNull=d,t.isString=y,t.listGroup=function(t,n){var e=kt(t,n);function r(t,n,r,i,a){var o=H(e.data,(function(t){return 0===_t(t.uidPath,n,(function(t,n){return t===n})).length})),u=yt("",a);if(o)try{switch(t){case"_columnRiseRatio":case"_columnTotal":case"_columnProportion":var c=o[t][r];return d(c)?u:i(c);default:var l=o[t][r].summary;return d(l)?u:i(l,o[t][r].data)}}catch(f){return u}return u}function i(t,n,e,i){return r("_columns",t,n,e,i)}function a(t,n,e,i){return r("_columnProportion",t,n,e,i)}return{data:e.data,getCellValue:i,getCellVerticalRiseRatio:function(t,n,e,i){return r("_columnRiseRatio",t,n,e,i)},getCellVerticalTotal:function(t,n,i,a){if("*"===t){var o=e.total[n];return d(o)?yt("",a):i(o)}return r("_columnTotal",t,n,i,a)},getCellVerticalProportion:a,getRowCellValue:function(t,n,e,r){var a={};return n.forEach((function(n){a[n.id]=i(t,n.field,e,r)})),a},getRowVerticalProportion:function(t,n,e,r){var i={};return n.forEach((function(n){i[n.id]=a(t,n.field,e,r)})),i},getOriginGroupData:function(t,n){var r,i,a=H(e.data,(function(n){return 0===_t(n.uidPath,t,(function(t,n){return t===n})).length}));return a&&null!==(r=null===(i=a._columns[n])||void 0===i?void 0:i.data)&&void 0!==r?r:[]},getOriginAllData:function(){return t}}},t.logExport=function(){var t=X(P(Wt),{id:"id",pid:"pid",children:"children"});return rt(t,(function(t){var n;null===(n=t.children)||void 0===n||n.sort((function(t,n){return new Date(t.time).getTime()-new Date(n.time).getTime()}))})),{flatList:P(Wt),treeList:t}},t.logRecord=function(t,n,e){var r=Yt(t,n,"",!e);return function(t,n){Yt(t,n,r,!e)}},t.mapKvPair=function(t,n){var e={};for(var r in t)e[r]=n(P(t[r]),r);return e},t.mapTree=nt,t.max=function(t,n){return Vt(t,{spaceRatio:0,getter:n}).max},t.min=function(t,n){return Vt(t,{spaceRatio:0,getter:n}).min},t.mixInZeroWidthUnicode=function(t){return W(t,"").join("‎")},t.numberToChinese=function(t,n){var e,r,i;n?(e=["角","分","毫","厘"],r="元",i="整"):(e=["","","",""],r="点",i="");var a=e.length,o=t<0?"负":"";if((t=Math.abs(t))>=1e15)return"超出最大处理数字";for(var u,c,l="",f=W(t.toString(),"."),s=f[0],d=f[1]||"",h=0,v=0,m=s.length;v<m;v++)u=qt[(c=m-1-v)%zt],"0"===s[v]?h++:(h&&(l+=Kt(0)),h=0,l+=Kt(s[v])+u),""==u&&h<zt&&(l+=Bt[c/zt]);if(l=o+l,d){l+=r;for(var p=0;p<d.length;p++)p<a&&(l+=Kt(d[p])+e[p])}else n?l=l+r+i:l+=i;return l},t.padEnd=G,t.padMinMax=function(t){for(var n,e,r=arguments.length,i=new Array(r>1?r-1:0),a=1;a<r;a++)i[a-1]=arguments[a];if(i.forEach((function(t){t.forEach((function(t){var r=R(t);n=d(n)?r:Math.min(n,r),e=d(e)?r:Math.max(e,r)}))})),!d(n)&&!d(e)){var o=e-n;n-=o*t,e+=o*t}return{min:n,max:e}},t.padStart=K,t.param=w,t.parseQuery=N,t.parseTreeToTableHeader=function(t){var n=Mt(nt(t,"children",(function(t){return{field:t.field,title:t.title,count:At(t)}})),[],0,0);return Ft(n),{columns:Dt(n),data:n}},t.randomColor=function(){return"rgba("+Z(0,255,!0)+","+Z(0,255,!0)+","+Z(0,255,!0)+",1)"},t.repeatArray=function(t,n){for(var e=[];e.length<n;)e=e.concat(t);return e=e.splice(0,n)},t.repeatString=U,t.rgbaToHex=function(t){var n=W(t=C(t,"*").replace(/^rgba?\((.*)\)$/g,"$1"),",").map((function(t){return R(t)})),e=yt(1,n[3]),r=Math.floor(e*n[0]+255*(1-e)),i=Math.floor(e*n[1]+255*(1-e)),a=Math.floor(e*n[2]+255*(1-e));return"#"+("0"+r.toString(16)).slice(-2)+("0"+i.toString(16)).slice(-2)+("0"+a.toString(16)).slice(-2)},t.roundFixed=Y,t.shake=function(t,n){var e=Object.assign({string:!0,array:!0,kvPair:!0},n);return $(t=P(t),e),t},t.shortNumber=Ct,t.signNumber=function(t){if(d(t))return"";var n="";return t>0?n="+":t<0&&(n="-"),""+n+t},t.sortCompare=function(t,n,e){if(!d(n)||!d(e)){if(d(n))return"asc"===t?1:-1;if(d(e))return"asc"===t?-1:1;var r="asc"===t?n-e:e-n;return 0===r?undefined:r}},t.sortWithIndex=function(t,n){for(var e=[],r=0;r<t.length;r++)e[r]=t[n[r]];return e},t.spanTable=function(t,n){var e=P(t),r={};function i(t,n){var i=0;e.forEach((function(a,o){var u,c;a.$rowSpan=null!==(u=a.$rowSpan)&&void 0!==u?u:{};var l=a[t];if(r[t]=null!==(c=r[t])&&void 0!==c?c:0,r[t]>1)a.$rowSpan[t]=0,r[t]--;else{var f=function(t,n,e,r){var i=1;for(t++;t<r.length;t++){var a=r[t][n];if(a!==e&&!T(a))break;i++}return i}(o,t,l,e);if(void 0!==n){var s=function(t,n,e){for(var r=0;n>=0&&!((r=t[n].$rowSpan[e])>0);n--);return r}(e,o,n);i>0?i+f>=s?(f=s-i,i=0):i+=f:f<s?i=f:f=s}r[t]=f,a.$rowSpan[t]=r[t]}}))}return n.forEach((function(t,e){i(t,n[e-1])})),e.forEach((function(t){t.$colField={};var e=0;n.forEach((function(r,i){var a=t[r];e>1?(t.$colField[r]=0,e--):(e=function(t,n,e,r){var i=1;for(t++;t<r.length;t++){var a=C(e[r[t]]);if(a!==n&&!T(a))break;i++}return i}(i,a,t,n),t.$colField[r]=e)}))})),e},t.split=W,t.thousands=function(t,n,e){n=n||3,e=e||",";var r=y(t)?t:h(t),i=!1;A(r)&&(i=R(r)<0,r=r.replace(/^-|\+/,""));var a=r.replace(/([^.]*)?(\.)?(.*)?/,(function(t,r,i,a){return h(r).replace(new RegExp("(.(?=(.{"+n+"})+$))","g"),"$1"+e)+h(i)+h(a)}));return i&&(a="-"+a),a},t.throttle=function(t,n,e){var r,i,a,o,u=yt(500,n),{leading:c,trailing:l}=jt({leading:!0,trailing:!0},e),f=0,s=0,d=0,h=!1;function v(){f=0,d=0}function m(){l&&(d>1||!c)?(p(),o=setTimeout(v,u)):v()}function p(){f=+new Date,t.apply(r,a)}function g(){if(!h){d++;for(var t=arguments.length,n=new Array(t),e=0;e<t;e++)n[e]=arguments[e];a=n,r=this,s=+new Date,clearTimeout(i),clearTimeout(o),0===f?c?p():f=s:s-f>=u&&p(),i=setTimeout(m,u)}}return g.cancel=function(){clearTimeout(i),clearTimeout(o)},g.dispose=function(){clearTimeout(i),clearTimeout(o),h=!0},g},t.toCamelCase=function(t){return h(t).replace(/(-\w)/g,(function(t,n){return n.toUpperCase()})).replace(/-/g,"")},t.tree=X,t.treeFilter=function(t,n){var e=[];return function r(t,e){for(var i=0;i<t.length;i++){var a=t[i],o=n(a);if(g(a.children)&&(o||(o=!!H(a.children,(function(t){return n(t)})))),o){var u={};for(var c in a)"children"!==c&&(u[c]=a[c]);g(a.children)&&(u.children=[],r(a.children,u.children)),e.push(u)}}}(t,e),rt(e,(function(t){t.children&&0===t.children.length&&delete t.children})),e},t.treeLeafs=Lt,t.trim=C,t.union=function(){for(var t=arguments.length,n=new Array(t),e=0;e<t;e++)n[e]=arguments[e];var r=new Set(n);return Array.from(r)},t.urlToGet=function(t,n){t=h(t);var e={};"FormData"!==p(n)&&(e=_(n)?n:N(n));var r=N(t=t.replace(/(\{\{)(.*)?(\}\})/g,(function(t,n,r,i){r=C(r);var a=e[r];return delete e[r],a}))),i=w(e=Object.assign(r,e));return i&&(t=(t=t.replace(/\?.*/,""))+"?"+i),t},t.uuid=tt,t.variableHasValue=V,t.zjxkjPerformanceTable=function(t,n){t.dataInfo=k(t.dataInfo),0===t.headers.length&&(t.row=[]);var e=on(nt(X(t.row,{id:"id",pid:"parentTaskId",children:"children"}),"children",(function(t){var n,e=g(t.children)&&t.children.length?t.attrs[0]:void 0;return{id:t.id,pid:t.pid,label:null!==(n=null==e?void 0:e.value)&&void 0!==n?n:"END",meta:{attrId:null==e?void 0:e.attrId},ext:t}})),[],0,0),r=un(e,t.headers),i=e.map((function(t,n){var e=[];return r.list.forEach((function(n,i){var a=t.filter((function(t){return t.meta.attrId===n.attrId})),o=a[n.attrIndex];if(o){var u=a[n.attrIndex+1]?1:r.count[n.attrId]-n.attrIndex;o.colspan=u,e.push(o)}else e.push({dataId:"-",colspan:0,rowspan:1,meta:{attrId:n.attrId},content:"占位"})})),e}));return function(t,n,e,r){var i=t.map((function(t,n){return{attrId:t.attrId,field:rn(n),label:t.label,colspan:t.colspan}})),a=n.map((function(t){var n,i=(n=t)[n.length-1],a={id:null==i?void 0:i.dataId,meta:{attrId:i.meta.attrId,completeRate:C(i.meta.completeRate),comment:C(i.meta.comment),scoreActual:C(i.meta.scoreActual),completeValue:C(i.meta.completeValue)},colspan:{},rowspan:{},cell:{}};return t.forEach((function(t,n){var i=rn(n),o=[];o=t.meta.cellId?e.filter((function(n){return n.taskId===t.meta.cellId})).map((function(n){var e,i,a=null!==(e=null==r||null===(i=r[n.id])||void 0===i?void 0:i.clickable)&&void 0!==e&&e;return{key:tt(),cellId:t.meta.cellId,businessType:n.type,businessTypeName:en(n.type),businessId:n.id,businessLink:n.url,content:C(n.content),clickable:a}})):[{key:tt(),cellId:t.meta.cellId,businessType:1,businessTypeName:en(1),businessId:undefined,businessLink:undefined,content:C(t.content),clickable:!1}],a.cell[i]=o,a.colspan[i]=t.colspan,a.rowspan[i]=t.rowspan})),a})),o=a.reduce((function(t,n){return t+R(n.meta.completeValue)}),0);return{headers:i,body:a,totalScore:o}}(r.list,i,t.dataInfo,n)}}));
